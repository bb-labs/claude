!function(t){var e={};function r(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){(function(t){var a=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},a=0;a<e.length;a++)r[e[a]]=Object.getOwnPropertyDescriptor(t,e[a]);return r},i=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(o(arguments[r]));return e.join(" ")}r=1;for(var a=arguments,s=a.length,n=String(t).replace(i,function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(a[r++]);case"%d":return Number(a[r++]);case"%j":try{return JSON.stringify(a[r++])}catch(t){return"[Circular]"}default:return t}}),l=a[r];r<s;l=a[++r])m(l)||!R(l)?n+=" "+l:n+=" "+o(l);return n},e.deprecate=function(r,a){if(void 0!==t&&!0===t.noDeprecation)return r;if(void 0===t)return function(){return e.deprecate(r,a).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(a);t.traceDeprecation?console.trace(a):console.error(a),i=!0}return r.apply(this,arguments)}};var s,n={};function o(t,r){var a={seen:[],stylize:h};return arguments.length>=3&&(a.depth=arguments[2]),arguments.length>=4&&(a.colors=arguments[3]),d(r)?a.showHidden=r:r&&e._extend(a,r),w(a.showHidden)&&(a.showHidden=!1),w(a.depth)&&(a.depth=2),w(a.colors)&&(a.colors=!1),w(a.customInspect)&&(a.customInspect=!0),a.colors&&(a.stylize=l),u(a,t,a.depth)}function l(t,e){var r=o.styles[e];return r?"["+o.colors[r][0]+"m"+t+"["+o.colors[r][1]+"m":t}function h(t,e){return t}function u(t,r,a){if(t.customInspect&&r&&b(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(a,t);return y(i)||(i=u(t,i,a)),i}var s=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(y(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(p(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,r);if(s)return s;var n=Object.keys(r),o=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(n);if(t.showHidden&&(n=Object.getOwnPropertyNames(r)),x(r)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return c(r);if(0===n.length){if(b(r)){var l=r.name?": "+r.name:"";return t.stylize("[Function"+l+"]","special")}if(I(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if($(r))return t.stylize(Date.prototype.toString.call(r),"date");if(x(r))return c(r)}var h,R="",v=!1,S=["{","}"];(g(r)&&(v=!0,S=["[","]"]),b(r))&&(R=" [Function"+(r.name?": "+r.name:"")+"]");return I(r)&&(R=" "+RegExp.prototype.toString.call(r)),$(r)&&(R=" "+Date.prototype.toUTCString.call(r)),x(r)&&(R=" "+c(r)),0!==n.length||v&&0!=r.length?a<0?I(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),h=v?function(t,e,r,a,i){for(var s=[],n=0,o=e.length;n<o;++n)O(e,String(n))?s.push(f(t,e,r,a,String(n),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(f(t,e,r,a,i,!0))}),s}(t,r,a,o,n):n.map(function(e){return f(t,r,a,o,e,v)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(h,R,S)):S[0]+R+S[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,r,a,i,s){var n,o,l;if((l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?o=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(o=t.stylize("[Setter]","special")),O(a,i)||(n="["+i+"]"),o||(t.seen.indexOf(l.value)<0?(o=m(r)?u(t,l.value,null):u(t,l.value,r-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.stylize("[Circular]","special")),w(n)){if(s&&i.match(/^\d+$/))return o;(n=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=t.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=t.stylize(n,"string"))}return n+": "+o}function g(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function m(t){return null===t}function p(t){return"number"==typeof t}function y(t){return"string"==typeof t}function w(t){return void 0===t}function I(t){return R(t)&&"[object RegExp]"===v(t)}function R(t){return"object"==typeof t&&null!==t}function $(t){return R(t)&&"[object Date]"===v(t)}function x(t){return R(t)&&("[object Error]"===v(t)||t instanceof Error)}function b(t){return"function"==typeof t}function v(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(r){if(w(s)&&(s=t.env.NODE_DEBUG||""),r=r.toUpperCase(),!n[r])if(new RegExp("\\b"+r+"\\b","i").test(s)){var a=t.pid;n[r]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",r,a,t)}}else n[r]=function(){};return n[r]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=g,e.isBoolean=d,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=p,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=I,e.isObject=R,e.isDate=$,e.isError=x,e.isFunction=b,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(2);var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),N[t.getMonth()],e].join(" ")}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",T(),e.format.apply(e,arguments))},e.inherits=r(3),e._extend=function(t,e){if(!e||!R(e))return t;for(var r=Object.keys(e),a=r.length;a--;)t[r[a]]=e[r[a]];return t};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(E&&t[E]){var e;if("function"!=typeof(e=t[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,E,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,a=new Promise(function(t,a){e=t,r=a}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,a){t?r(t):e(a)});try{t.apply(this,i)}catch(t){r(t)}return a}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),E&&Object.defineProperty(e,E,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,a(t))},e.promisify.custom=E,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],a=0;a<arguments.length;a++)r.push(arguments[a]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var s=this,n=function(){return i.apply(s,arguments)};e.apply(this,r).then(function(e){t.nextTick(n,null,e)},function(e){t.nextTick(A,e,n)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,a(e)),r}}).call(this,r(1))},function(t,e){var r,a,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{a="function"==typeof clearTimeout?clearTimeout:n}catch(t){a=n}}();var l,h=[],u=!1,c=-1;function f(){u&&l&&(u=!1,l.length?h=l.concat(h):c=-1,h.length&&g())}function g(){if(!u){var t=o(f);u=!0;for(var e=h.length;e;){for(l=h,h=[];++c<e;)l&&l[c].run();c=-1,e=h.length}l=null,u=!1,function(t){if(a===clearTimeout)return clearTimeout(t);if((a===n||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(t);try{a(t)}catch(e){try{return a.call(null,t)}catch(e){return a.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new d(t,e)),1!==h.length||u||o(g)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";r.r(e);var a=r(0);const i=":",s=/\]\,(\s*)\[/g,n="],\n$1[",o="shape",l="offset",h="contig",u="strides",c=/\d+/,f=/\d*:\d*/,g=Object.assign(Math,{add:function(t,e){return t+e},subtract:function(t,e){return t-e},divide:function(t,e){return t/e},multiply:function(t,e){return t*e}}),d=function(t,e){var r={re:0,im:0};if(null==t)r.re=r.im=0;else if(void 0!==e)r.re=t,r.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)r.re=t.re,r.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return Complex.INFINITY;r.re=t.abs*Math.cos(t.arg),r.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return Complex.INFINITY;r.re=t.r*Math.cos(t.phi),r.im=t.r*Math.sin(t.phi)}else 2===t.length?(r.re=t[0],r.im=t[1]):parser_exit();break;case"string":r.im=r.re=0;var a=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,s=0;null===a&&parser_exit();for(var n=0;n<a.length;n++){var o=a[n];" "===o||"\t"===o||"\n"===o||("+"===o?i++:"-"===o?s++:"i"===o||"I"===o?(i+s===0&&parser_exit()," "===a[n+1]||isNaN(a[n+1])?r.im+=parseFloat((s%2?"-":"")+"1"):(r.im+=parseFloat((s%2?"-":"")+a[n+1]),n++),i=s=0):((i+s===0||isNaN(o))&&parser_exit(),"i"===a[n+1]||"I"===a[n+1]?(r.im+=parseFloat((s%2?"-":"")+o),n++):r.re+=parseFloat((s%2?"-":"")+o),i=s=0))}i+s>0&&parser_exit();break;case"number":r.im=0,r.re=t;break;default:parser_exit()}return isNaN(r.re)||isNaN(r.im),r},m=function(t,e){var r="";return 0!==t&&(r+=t),0!==e&&(0!==t?r+=e<0?" - ":" + ":e<0&&(r+="-"),1!==(e=Math.abs(e))&&(r+=e),r+="i"),r||"0"},p=function(t,e=[]){return t.constructor===Number||t.constructor===String?e:p(t[0],e.concat(t.length))},y=function({short:t,delta:e}){return t.reshape({shape:new Array(e).fill(1).concat(t.shape)})};function w(t){return this.shape[t]}const I=function({axes:t=[...this.shape.keys()]}){const e=new Set(t),r=t,a=t.map(w,this).reduce(g.multiply),i=[],s=[];for(let t=0;t<this.shape.length;t++)e.has(t)?s.push(1):(r.push(t),i.push(this.shape[t]),s.push(this.shape[t]));return{resultShape:i,alignedShape:s,axesShape:r,axesSize:a,fullShape:this.shape,fullSize:this.size}},R=function(t){const e=[],r=[],a=[],i=this.shape,s=t.with.shape||this.shape;for(let t=0;t<i.length;t++)1===i[t]?(r.push(t),a.push(s[t])):1===s[t]?(r.push(t),a.push(i[t])):i[t]===s[t]&&(e.push(t),a.push(i[t]));const n=r.concat(e);return{fullShape:a,axesShape:n,axesSize:n.map(w,this).reduce(g.multiply),fullSize:a.reduce(g.multiply)}},$=function(t){let e=-1;for(let r=0;r<t.length;r++){if(e>=0&&t[r].constructor===String&&r-e>1)return!1;t[r].constructor===String&&(e=r)}return!0},x=function(t,e){const r=new Array(t.length);let a=e||1;r[r.length-1]=a;for(let e=t.length-1;e>0;e--)r[e-1]=a*=t[e];return r},b=function(t,e){const r=new Array(t.length),a=t.reduce(g.multiply,1);for(let i=0;i<t.length;i++)r[i]=t[i]<0?-e/a:t[i];return r};class v{constructor(t){this.shape=o in t?t.shape:[],this.offset=l in t?t.offset:0,this.contig=!(h in t)||t.contig,this.strides=u in t?t.strides:x(this.shape),this.id=`${this.shape}|${this.strides}|${this.offset}`,this.size=this.shape.reduce(g.multiply,1),this.lastStride=this.strides[this.strides.length-1]}copy(){return new v(JSON.parse(JSON.stringify(this)))}slice(t){const e=new Array,r=new Array,a=$(t);let s=this.offset;for(let a=0;a<this.shape.length;a++)if(t[a]===i||void 0===t[a])e.push(this.shape[a]),r.push(this.strides[a]);else if(f.test(t[a])){let[n,o]=t[a].split(i).map(Number);0===o&&(o=this.shape[a]),s+=this.strides[a]*n,e.push(o-n),r.push(this.strides[a])}else c.test(t[a])&&(s+=this.strides[a]*t[a]);return new v({shape:e,strides:r,offset:s,contig:a})}transpose(){return new v({shape:this.shape.slice().reverse(),strides:this.strides.slice().reverse(),offset:this.offset,contig:!1})}reshape(t){const e=b(t,this.size);return new v({shape:e,strides:x(e,this.lastStride)})}}const S=function(t){return new Function("args",`\n        const i0 = this.suite[${t[0]}] || (this.suite[${t[0]}] = {})\n\n        ${t.map(function(t,e){return e?`const i${e} = i${e-1}[${t}] || (i${e-1}[${t}] = {})`:""}).join("\n")}\n        \n        return i${t.length-1}[args.meta.method] || i${t.length-1}\n    `)},N=function(t){return new Function("args",`\n        let func = this.route(args)\n\n        if (func.constructor === Object)\n            ${T(t)}   \n\n        return func(args)\n    `)},T=function(t){return`switch(args.meta.method){\n        ${Object.entries(t).map(function([t,e]){return`case '${t}': ${Object.keys(e).map(function(e,r){return(r?"else ":"")+`if(${e}){ \n                    func = \n                    func[args.meta.method] = \n                    this.methods['${t}']['${e}'](args)\n                }`}).join("\n")} break`}).join("\n")}\n    }`};class O{constructor({hash:t,...e}){this.suite={},this.hash=t,this.methods=e,this.call=N(this.methods).bind(this),this.route=S(this.hash).bind(this)}static suite(t){return new O(t)}}const E=function(){return""},A={begin:E,middle:function({ofReal:t,ofImag:e,resultReal:r,resultImag:a}){return[`var scale = Math.exp(${t})`,`${r} = scale * Math.cos(${e})`,`${a} = scale * Math.sin(${e})`].join("\n")},end:E},_={begin:E,middle:function({ofReal:t,resultReal:e}){return`${e} = Math.sin(${t})`},end:E},z={begin:E,middle:function({ofReal:t,resultReal:e}){return`${e} = Math.cos(${t})`},end:E},j={begin:E,middle:function({ofReal:t,ofImag:e,withReal:r,withImag:a,resultReal:i,resultImag:s}){return[`${i} = ${t} + ${r}`,`${s} = ${e} + ${a}`].join("\n")},end:E},M={begin:E,middle:function({ofReal:t,ofImag:e,withReal:r,withImag:a,resultReal:i,resultImag:s}){return[`${i} = ${t} - ${r}`,`${s} = ${e} - ${a}`].join("\n")},end:E},P={begin:E,middle:function({ofReal:t,ofImag:e,withReal:r,withImag:a,resultReal:i,resultImag:s}){return[`var ac = ${t} * ${r}`,`var bd = ${e} * ${a}`,`var apb = (${t} + ${e})`,`var cpd = (${r} + ${a})`,`${i} = ac - bd`,`${s} = apb * cpd - ac - bd`].join("\n")},end:E},C={begin:E,middle:function({ofReal:t,ofImag:e,withReal:r,withImag:a,resultReal:i,resultImag:s}){return[`var mod = ${r} === 0 && ${a} === 0 ? 1 : ${r} * ${r} + ${a} * ${a}`,`${i} = (${t} * ${r} + ${e} * ${a}) / mod`,`${s} = (${e} * ${r} - ${t} * ${a}) / mod`].join("\n")},end:E},F={begin:E,middle:function({withReal:t,withImag:e,resultReal:r,resultImag:a}){return[`${r} = ${t}`,`${a} = ${e}`].join("\n")},end:E},D={begin:function(){return"args.result.data.real.fill(Number.POSITIVE_INFINITY)"},middle:function({ofReal:t,ofImag:e,resultReal:r,resultImag:a}){return[`if(${t} < ${r}) {`,`   ${r} = ${t}`,`   ${a} = ${e}`,"}"].join("\n")},end:E},k={begin:function(){return"args.result.data.real.fill(Number.NEGATIVE_INFINITY)"},middle:function({ofReal:t,ofImag:e,resultReal:r,resultImag:a}){return[`if(${t} > ${r}) {`,`   ${r} = ${t}`,`   ${a} = ${e}`,"}"].join("\n")},end:E},U={begin:function(){return["args.result.data.real.fill(0)","args.result.data.imag.fill(0)"]},middle:function({ofReal:t,ofImag:e,resultReal:r,resultImag:a}){return[`${r} += ${t}`,`${a} += ${e}`].join("\n")},end:E},L={begin:U.begin,middle:function({ofReal:t,ofImag:e,resultReal:r}){return`${r} += ${t} * ${t} + ${e} * ${e}`},end:function(){return"\n            for (let i = 0; i < args.result.data.real.length; i++) \n                args.result.data.real[i] = Math.sqrt(args.result.data.real[i])\n        "}},V={begin:U.begin,middle:U.middle,end:function(){return"\n            for (let i = 0; i < args.result.data.real.length; i++){\n                args.result.data.real[i] /= args.meta.axesSize\n                args.result.data.imag[i] /= args.meta.axesSize\n            }\n        "}};const B=function t(e){const r=Math.round(Math.sqrt(e.length));if(1===r)return F.middle({withReal:`args.of.data.real[${G.call(this,e[0])}]`,withImag:`args.of.data.imag[${G.call(this,e[0])}]`,resultReal:"var corefinal",resultImag:"var coimfinal"});if(2===r){const t=G.call(this,e[0]),r=G.call(this,e[1]),a=G.call(this,e[2]),i=G.call(this,e[3]);return[P.middle({ofReal:`args.of.data.real[${t}]`,ofImag:`args.of.data.imag[${t}]`,withReal:`args.of.data.real[${i}]`,withImag:`args.of.data.imag[${i}]`,resultReal:"var ar03",resultImag:"var ai03"}),P.middle({ofReal:`args.of.data.real[${a}]`,ofImag:`args.of.data.imag[${a}]`,withReal:`args.of.data.real[${r}]`,withImag:`args.of.data.imag[${r}]`,resultReal:"var ar21",resultImag:"var ai21"}),M.middle({ofReal:"ar03",ofImag:"ai03",withReal:"ar21",withImag:"ai21",resultReal:"var corefinal",resultImag:"var coimfinal"})].join("\n")}const a=[];for(let i=0;i<r;i++)a.push([t.call(this,Y(e,0,i)),P.middle({ofReal:`args.of.data.real[${G.call(this,e[i])}]`,ofImag:`args.of.data.imag[${G.call(this,e[i])}]`,withReal:"corefinal",withImag:"coimfinal",resultReal:"corefinal",resultImag:"coimfinal"}),P.middle({ofReal:`${Math.pow(-1,i%2)}`,ofImag:"0",withReal:"corefinal",withImag:"coimfinal",resultReal:`core${i}`,resultImag:`coim${i}`})].join("\n"));return[...a,F.middle({withReal:[...new Array(r).keys()].map(function(t){return`core${t}`}).join("+"),withImag:[...new Array(r).keys()].map(function(t){return`coim${t}`}).join("+"),resultReal:"corefinal",resultImag:"coimfinal"})].join("\n")},G=function(t,e){return void 0===e&&([t,e]=H.call(this,t)),this.offset+t*this.strides[0]+e*this.strides[1]},H=function(t){const e=this.shape[0];return[Math.floor(t/e)%this.shape[0],Math.floor(t/1)%this.shape[1]]},Y=function(t,e,r){const a=Math.round(Math.sqrt(t.length));return t.filter(function(t,i){return i%a!==r&&Math.floor(i/a)!==e})},X=function({arrayName:t,indices:e}){return`${t}.offset + \n                ${e[0]} * ${t}.strides[0] + \n                ${e[1]} * ${t}.strides[1]`};var J={},W={...{cross:{true:function(t){const e=3===t.of.shape[0]?t.of.strides[0]:t.of.strides[1],r=3===t.with.shape[0]?t.with.strides[0]:t.with.strides[1],a=3===t.result.shape[0]?t.result.strides[0]:t.result.strides[1];return new Function("args",[P.middle({ofReal:`args.of.data.real[${1*e+t.of.offset}]`,ofImag:`args.of.data.imag[${1*e+t.of.offset}]`,withReal:`args.with.data.real[${2*r+t.with.offset}]`,withImag:`args.with.data.imag[${2*r+t.with.offset}]`,resultReal:"const cr00",resultImag:"const ci00"}),P.middle({ofReal:`args.of.data.real[${2*e+t.of.offset}]`,ofImag:`args.of.data.imag[${2*e+t.of.offset}]`,withReal:`args.with.data.real[${1*r+t.with.offset}]`,withImag:`args.with.data.imag[${1*r+t.with.offset}]`,resultReal:"const cr01",resultImag:"const ci01"}),M.middle({ofReal:"cr00",ofImag:"ci00",withReal:"cr01",withImag:"ci01",resultReal:`args.result.data.real[${t.result.offset+0*a}]`,resultImag:`args.result.data.imag[${t.result.offset+0*a}]`}),P.middle({ofReal:`args.of.data.real[${2*e+t.of.offset}]`,ofImag:`args.of.data.imag[${2*e+t.of.offset}]`,withReal:`args.with.data.real[${0*r+t.with.offset}]`,withImag:`args.with.data.imag[${0*r+t.with.offset}]`,resultReal:"const cr10",resultImag:"const ci10"}),P.middle({ofReal:`args.of.data.real[${0*e+t.of.offset}]`,ofImag:`args.of.data.imag[${0*e+t.of.offset}]`,withReal:`args.with.data.real[${2*r+t.with.offset}]`,withImag:`args.with.data.imag[${2*r+t.with.offset}]`,resultReal:"const cr11",resultImag:"const ci11"}),M.middle({ofReal:"cr10",ofImag:"ci10",withReal:"cr11",withImag:"ci11",resultReal:`args.result.data.real[${t.result.offset+1*a}]`,resultImag:`args.result.data.imag[${t.result.offset+1*a}]`}),P.middle({ofReal:`args.of.data.real[${0*e+t.of.offset}]`,ofImag:`args.of.data.imag[${0*e+t.of.offset}]`,withReal:`args.with.data.real[${1*r+t.with.offset}]`,withImag:`args.with.data.imag[${1*r+t.with.offset}]`,resultReal:"const cr20",resultImag:"const ci20"}),P.middle({ofReal:`args.of.data.real[${1*e+t.of.offset}]`,ofImag:`args.of.data.imag[${1*e+t.of.offset}]`,withReal:`args.with.data.real[${0*r+t.with.offset}]`,withImag:`args.with.data.imag[${0*r+t.with.offset}]`,resultReal:"const cr21",resultImag:"const ci21"}),M.middle({ofReal:"cr20",ofImag:"ci20",withReal:"cr21",withImag:"ci21",resultReal:`args.result.data.real[${t.result.offset+2*a}]`,resultImag:`args.result.data.imag[${t.result.offset+2*a}]`}),"return args.result"].join("\n"))}}},...{inverse:{"args.result.size > 16":function(){return new Function("args",["const dim = Math.floor(Math.sqrt(args.result.size))","const copy = args.of.copy()","for (let i = 0; i < dim; i += 1) {",`let er = copy.data.real[${X({arrayName:"copy",indices:["i","i"]})}]`,`let ei = copy.data.imag[${X({arrayName:"copy",indices:["i","i"]})}]`,`if(Math.abs(er) < 1e-5 && Math.abs(ei < 1e-5)){\n            for (ii = i + 1; ii < dim; ii += 1) {\n                let pr = copy.data.real[${X({arrayName:"copy",indices:["ii","i"]})}]\n                let pi = copy.data.imag[${X({arrayName:"copy",indices:["ii","i"]})}]\n\n                if (Math.abs(pr) > 1e-5 || Math.abs(pi) > 1e-5) {\n                    for (j = 0; j < dim; j++) {\n                        er = copy.data.real[${X({arrayName:"copy",indices:["i","j"]})}]\n                        ei = copy.data.imag[${X({arrayName:"copy",indices:["i","j"]})}]\n                        \n                        copy.data.real[${X({arrayName:"copy",indices:["i","j"]})}] = copy.data.real[${X({arrayName:"copy",indices:["ii","j"]})}]\n                        copy.data.imag[${X({arrayName:"copy",indices:["i","j"]})}] = copy.data.imag[${X({arrayName:"copy",indices:["ii","j"]})}]\n                        \n                        copy.data.real[${X({arrayName:"copy",indices:["ii","j"]})}] = er\n                        copy.data.imag[${X({arrayName:"copy",indices:["ii","j"]})}] = ei\n\n\n                        er = args.result.data.real[${X({arrayName:"args.result",indices:["i","j"]})}]\n                        ei = args.result.data.imag[${X({arrayName:"args.result",indices:["i","j"]})}]\n\n                        args.result.data.real[${X({arrayName:"args.result",indices:["i","j"]})}] = args.result.data.real[${X({arrayName:"args.result",indices:["ii","j"]})}]\n                        args.result.data.imag[${X({arrayName:"args.result",indices:["i","j"]})}] = args.result.data.imag[${X({arrayName:"args.result",indices:["ii","j"]})}]\n\n                        args.result.data.real[${X({arrayName:"args.result",indices:["ii","j"]})}] = er\n                        args.result.data.imag[${X({arrayName:"args.result",indices:["ii","j"]})}] = ei\n\n                    }\n\n                    break\n                }\n            }\n\n            er = copy.data.real[${X({arrayName:"copy",indices:["i","i"]})}]\n            ei = copy.data.imag[${X({arrayName:"copy",indices:["i","i"]})}]\n        }`,"for (let j = 0; j < dim; j++) {",F.middle({withReal:`copy.data.real[${X({arrayName:"copy",indices:["i","j"]})}]`,withImag:`copy.data.imag[${X({arrayName:"copy",indices:["i","j"]})}]`,resultReal:"var tempReal",resultImag:"var tempImag"}),C.middle({ofReal:"tempReal",ofImag:"tempImag",withReal:"er",withImag:"ei",resultReal:`copy.data.real[${X({arrayName:"copy",indices:["i","j"]})}]`,resultImag:`copy.data.imag[${X({arrayName:"copy",indices:["i","j"]})}]`}),F.middle({withReal:`args.result.data.real[${X({arrayName:"args.result",indices:["i","j"]})}]`,withImag:`args.result.data.imag[${X({arrayName:"args.result",indices:["i","j"]})}]`,resultReal:"var tempReal",resultImag:"var tempImag"}),C.middle({ofReal:"tempReal",ofImag:"tempImag",withReal:"er",withImag:"ei",resultReal:`args.result.data.real[${X({arrayName:"args.result",indices:["i","j"]})}]`,resultImag:`args.result.data.imag[${X({arrayName:"args.result",indices:["i","j"]})}]`}),"}","for (let ii = 0; ii < dim; ii++) {","if (ii == i) { continue; }",`er = copy.data.real[${X({arrayName:"copy",indices:["ii","i"]})}]`,`ei = copy.data.imag[${X({arrayName:"copy",indices:["ii","i"]})}]`,"for (let j = 0; j < dim; j++) {",P.middle({ofReal:"er",ofImag:"ei",withReal:`copy.data.real[${X({arrayName:"copy",indices:["i","j"]})}]`,withImag:`copy.data.imag[${X({arrayName:"copy",indices:["i","j"]})}]`,resultReal:"let elimCopyReal",resultImag:"let elimCopyImag"}),M.middle({ofReal:`copy.data.real[${X({arrayName:"copy",indices:["ii","j"]})}]`,ofImag:`copy.data.imag[${X({arrayName:"copy",indices:["ii","j"]})}]`,withReal:"elimCopyReal",withImag:"elimCopyImag",resultReal:`copy.data.real[${X({arrayName:"copy",indices:["ii","j"]})}]`,resultImag:`copy.data.imag[${X({arrayName:"copy",indices:["ii","j"]})}]`}),P.middle({ofReal:"er",ofImag:"ei",withReal:`args.result.data.real[${X({arrayName:"args.result",indices:["i","j"]})}]`,withImag:`args.result.data.imag[${X({arrayName:"args.result",indices:["i","j"]})}]`,resultReal:"let elimResultReal",resultImag:"let elimResultImag"}),M.middle({ofReal:`args.result.data.real[${X({arrayName:"args.result",indices:["ii","j"]})}]`,ofImag:`args.result.data.imag[${X({arrayName:"args.result",indices:["ii","j"]})}]`,withReal:"elimResultReal",withImag:"elimResultImag",resultReal:`args.result.data.real[${X({arrayName:"args.result",indices:["ii","j"]})}]`,resultImag:`args.result.data.imag[${X({arrayName:"args.result",indices:["ii","j"]})}]`}),"}","}","}","return args.result"].join("\n"))},"args.result.size <= 16":function(t){const e=Math.round(Math.sqrt(t.of.size)),r=[...new Array(t.of.size).keys()];return new Function("args",[...new Array(t.result.size).fill(null).map(function(a,i){const s=Math.floor(i/e),n=i%e,o=G.call(t.result,s,n);return[B.call(t.of,Y(r,n,s)),P.middle({ofReal:`${Math.pow(-1,(s+n)%2)}`,ofImag:"0",withReal:"corefinal",withImag:"coimfinal",resultReal:`args.result.data.real[${o}]`,resultImag:`args.result.data.imag[${o}]`})].join("\n")}),...new Array(e).fill(null).map(function(e,r){const a=G.call(t.of,0,r),i=G.call(t.result,r,0);return P.middle({ofReal:`args.of.data.real[${a}]`,ofImag:`args.of.data.imag[${a}]`,withReal:`args.result.data.real[${i}]`,withImag:`args.result.data.imag[${i}]`,resultReal:`dr${r}`,resultImag:`di${r}`})}),"let detReal =0,  detImag = 0",F.middle({withReal:[...new Array(e).keys()].map(function(t){return`dr${t}`}).join("+"),withImag:[...new Array(e).keys()].map(function(t){return`di${t}`}).join("+"),resultReal:"detReal",resultImag:"detImag"}),...new Array(t.result.size).fill(null).map(function(r,a){const i=Math.floor(a/e),s=a%e,n=G.call(t.result,i,s);return[F.middle({withReal:`args.result.data.real[${n}]`,withImag:`args.result.data.imag[${n}]`,resultReal:"tempResultReal",resultImag:"tempResultImag"}),C.middle({ofReal:"tempResultReal",ofImag:"tempResultImag",withReal:"detReal",withImag:"detImag",resultReal:`args.result.data.real[${n}]`,resultImag:`args.result.data.imag[${n}]`})].join("\n")}),"return args.result"].join("\n"))}}},...{matMult:{"args.result.size > 500":function(){return new Function("args",["for (let r = 0; \n            r < args.of.shape[0]; \n            r++)","for (let c = 0; \n            c < args.with.shape[1]; \n            c++)","for (let s = 0; \n            s < args.of.shape[1]; \n            s++) {",P.middle({ofReal:"args.of.data.real[r * args.of.strides[0] + s * args.of.strides[1] + args.of.offset]",ofImag:"args.of.data.imag[r * args.of.strides[0] + s * args.of.strides[1] + args.of.offset]",withReal:"args.with.data.real[r * args.with.strides[0] + s * args.with.strides[1] + args.with.offset]",withImag:"args.with.data.imag[r * args.with.strides[0] + s * args.with.strides[1] + args.with.offset]",resultReal:"const re",resultImag:"const im"}),U.middle({ofReal:"re",ofImag:"im",resultReal:"args.result.data.real[r * args.result.strides[0] + c * args.result.strides[1]]",resultImag:"args.result.data.imag[r * args.result.strides[0] + c * args.result.strides[1]]"}),"}","return args.result"].join("\n"))},"args.result.size <= 500":function(t){const e=t.of.shape[0],r=t.with.shape[1],a=t.of.shape[1];return new Function("args",[...[...new Array(e*r).keys()].map(function(i){const s=Math.floor(i/r)%e,n=Math.floor(i/1)%r,o=t.result.offset+s*t.result.strides[0]+n*t.result.strides[1];return[...[...new Array(a).keys()].map(function(e){const r=s*t.of.strides[0]+e*t.of.strides[1]+t.of.offset,a=n*t.with.strides[1]+e*t.with.strides[0]+t.with.offset;return P.middle({ofReal:`args.of.data.real[${r}]`,ofImag:`args.of.data.imag[${r}]`,withReal:`args.with.data.real[${a}]`,withImag:`args.with.data.imag[${a}]`,resultReal:`var sr${e}`,resultImag:`var si${e}`})}),F.middle({withReal:[...new Array(a).keys()].map(function(t){return`sr${t}`}).join("+"),withImag:[...new Array(a).keys()].map(function(t){return`si${t}`}).join("+"),resultReal:`args.result.data.real[${o}]`,resultImag:`args.result.data.imag[${o}]`})].join("\n")}),"return args.result"].join("\n"))}}}};function Z({array:t,axis:e,i:r,increment:a}){if(t&&t.shape&&t.shape[e]>1){const i=r*t.strides[e];t.offset+=a?i:-i}}function q({index:t,array:e}){t&&e&&t.push(e.offset)}const K=function t({indices:e={of:new Array,with:new Array,result:new Array},meta:r,depth:a=0,...i}){if(a===r.fullShape.length)return q({index:e.of,array:i.of}),q({index:e.with,array:i.with}),q({index:e.result,array:i.result}),e;const s=r.axesShape[a];for(let o=0;o<r.fullShape[s];o++){Z({array:i.of,axis:s,i:o,increment:!0}),Z({array:i.with,axis:s,i:o,increment:!0}),i.of!==i.result&&Z({array:i.result,axis:s,i:o,increment:!0});var n=t({meta:r,indices:e,depth:a+1,...i});Z({array:i.of,axis:s,i:o,increment:!1}),Z({array:i.with,axis:s,i:o,increment:!1}),i.of!==i.result&&Z({array:i.result,axis:s,i:o,increment:!1})}return n},Q=function(t){return`for(let a${t} = 0; \n                a${t} < args.meta.fullShape[${t}]; \n                a${t}++){`},tt=function({meta:t,...e}){return Object.entries(e).map(function([e,r]){if(!r.shape)return"";return`${e}Index = `+`args.${e}.offset + `+t.axesShape.map(function(t){return r.shape[t]>1?`a${t} * args.${e}.strides[${t}]`:0}).join("+")||0})};var et=function(t){return function(e){return new Function("args",[t.begin(e),...e.meta.axesShape.map(Q),...tt(e),t.middle({ofReal:"args.of.data.real[ofIndex]",ofImag:"args.of.data.imag[ofIndex]",withReal:"args.with.data.real[withIndex]",withImag:"args.with.data.imag[withIndex]",resultReal:"args.result.data.real[resultIndex]",resultImag:"args.result.data.imag[resultIndex]"}),"}".repeat(e.meta.fullShape.length),t.end(e),"return args.result"].join("\n"))}},rt=function(t){return function(e){return new Function("args",[t.begin(e),"for(let i = 0; i < this.indices.result.length; i++){",t.middle({ofReal:"args.of.data.real[this.indices.of[i]]",ofImag:"args.of.data.imag[this.indices.of[i]]",withReal:"args.with.data.real[this.indices.with[i]]",withImag:"args.with.data.imag[this.indices.with[i]]",resultReal:"args.result.data.real[this.indices.result[i]]",resultImag:"args.result.data.imag[this.indices.result[i]]"}),"}",t.end(e),"return args.result"].join("\n")).bind({indices:K(e)})}},at=function(t){return function(e){let r=K(e);const a=new Function("args",[t.begin(e),...[...new Array(e.meta.fullSize).keys()].map(function(e){return t.middle({ofReal:`args.of.data.real[${r.of[e]}]`,ofImag:`args.of.data.imag[${r.of[e]}]`,withReal:`args.with.data.real[${r.with[e]}]`,withImag:`args.with.data.imag[${r.with[e]}]`,resultReal:`args.result.data.real[${r.result[e]}]`,resultImag:`args.result.data.imag[${r.result[e]}]`})}),t.end(e),"return args.result"].join("\n"));return r=null,a}},it={},st={exp:{"args.meta.axesSize <= 20":at(A),"args.meta.axesSize <= 100":rt(A),"args.meta.axesSize > 100":et(A)},sin:{"args.meta.axesSize <= 20":at(_),"args.meta.axesSize <= 100":rt(_),"args.meta.axesSize > 100":et(_)},cos:{"args.meta.axesSize <= 20":at(z),"args.meta.axesSize <= 100":rt(z),"args.meta.axesSize > 100":et(z)},add:{"args.meta.axesSize <= 20":at(j),"args.meta.axesSize <= 100":rt(j),"args.meta.axesSize > 100":et(j)},subtract:{"args.meta.axesSize <= 20":at(M),"args.meta.axesSize <= 100":rt(M),"args.meta.axesSize > 100":et(M)},multiply:{"args.meta.axesSize <= 20":at(P),"args.meta.axesSize <= 100":rt(P),"args.meta.axesSize > 100":et(P)},divide:{"args.meta.axesSize <= 20":at(C),"args.meta.axesSize <= 100":rt(C),"args.meta.axesSize > 100":et(C)},assign:{"args.meta.axesSize <= 20":at(F),"args.meta.axesSize <= 100":rt(F),"args.meta.axesSize > 100":et(F)},min:{"args.meta.axesSize <= 20":at(D),"args.meta.axesSize <= 100":rt(D),"args.meta.axesSize > 100":et(D)},max:{"args.meta.axesSize <= 20":at(k),"args.meta.axesSize <= 100":rt(k),"args.meta.axesSize > 100":et(k)},mean:{"args.meta.axesSize <= 20":at(V),"args.meta.axesSize <= 100":rt(V),"args.meta.axesSize > 100":et(V)},norm:{"args.meta.axesSize <= 20":at(L),"args.meta.axesSize <= 100":rt(L),"args.meta.axesSize > 100":et(L)},sum:{"args.meta.axesSize <= 20":at(U),"args.meta.axesSize <= 100":rt(U),"args.meta.axesSize > 100":et(U)}};var nt={randint:function({low:t,high:e}){return t+Math.floor(Math.random()*(e-t))}},ot={};const lt=O.suite({...W,...st,...ot,hash:["args.of.id","args.with.id","args.result.id"]});lt.utils={...J,...it,...nt};var ht=lt;class ut{constructor({header:t,type:e,init:r=function(){return{real:new this.type(this.size),imag:new this.type(this.size)}}}){for(const e in t)this[e]=t[e];this.header=t,this.type=e||Float32Array,this.data=r.call(this)}static array(t){return new ut({type:t.type,header:new v({shape:p(t.with)}),init:function(){if(t.with.constructor===Array){const e=t.with.flat(Number.POSITIVE_INFINITY),r={real:new this.type(this.size),imag:new this.type(this.size)};for(let t=0;t<r.real.length;t++){const a=d(e[t]);r.real[t]=a.re,r.imag[t]=a.im}return r}if(t.with.constructor===String||t.with.constructor===Number){const e={real:new this.type(this.size),imag:new this.type(this.size)};for(let r=0;r<e.real.length;r++){const a=d(t.with);e.real[r]=a.re,e.imag[r]=a.im}return e}if(t.with.constructor===Int8Array||t.with.constructor===Uint8Array||t.with.constructor===Uint8ClampedArray||t.with.constructor===Int16Array||t.with.constructor===Uint16Array||t.with.constructor===Int32Array||t.with.constructor===Uint32Array||t.with.constructor===Float32Array)return this.type=t.with.constructor,{real:t.with,imag:new this.type(t.with.length)};throw"Usage: bb.array({ with: rawArray | typedArray, type: typedArrayConstructor })"}})}static zeros(t){return new ut({type:t.type,header:new v({shape:t.shape})})}static ones(t){return new ut({type:t.type,header:new v({shape:t.shape}),init:function(){return{real:new this.type(this.size).fill(1),imag:new this.type(this.size)}}})}static arange(t){return new ut({type:t.type,header:new v({shape:[g.round((t.stop-(t.start||0))/(t.step||1))]}),init:function(){const e={real:new this.type(this.size),imag:new this.type(this.size)};for(let r=t.start||0,a=0;r<t.stop;r+=t.step||1,a++)e.real[a]=r;return e}})}static rand(t){return new ut({type:Float32Array,header:new v({shape:t.shape}),init:function(){const t={real:new this.type(this.size),imag:new this.type(this.size)};for(let e=0;e<t.real.length;e++)t.real[e]=g.random()-1;return t}})}static randint(t){return new ut({type:t.type||Int32Array,header:new v({shape:t.shape}),init:function(){const e={real:new this.type(this.size),imag:new this.type(this.size)};for(let r=0;r<e.real.length;r++)e.real[r]=ht.utils.randint({low:t.low,high:t.high});return e}})}static eye(t){return new ut({type:t.type,header:new v({shape:t.shape}),init:function(){const t={real:new this.type(this.size),imag:new this.type(this.size)},e=this.strides.reduce(g.add),r=g.min(...this.shape);for(let a=0;a<r*e;a+=e)t.real[a]=1;return t}})}sanitize(t){t.with.constructor!==Array&&t.with.constructor!==String&&t.with.constructor!==Number||(t.with=ut.array({with:t.with}))}astype(t){return this.type=t.type,this.data.real=new this.type(this.data.real),this.data.imag=new this.type(this.data.imag),this}copy(t=this){return new ut({type:this.type,header:this.header,init:function(){return{real:t.data.real.slice(),imag:t.data.imag.slice()}}})}ravel(){return ut.array({with:this.toRaw()}).reshape({shape:[-1]})}gpair(t,e){this.sanitize(t),t.with.shape&&(t.with=y({short:t.with,delta:this.shape.length-t.with.shape.length}));const r=R.call(this,t);return ht.call({of:this,with:t.with,result:t.result||new ut({type:this.type,header:new v({shape:r.fullShape})}),meta:{method:e,...r}})}gself(t,e){const r=I.call(this,t);return ht.call({of:this,with:{id:""},result:t.result||new ut({type:this.type,header:new v({shape:r.alignedShape})}),meta:{method:e,...r}}).reshape({shape:r.resultShape})}exp(){return this.gpair({with:{id:""}},this.exp.name)}sin(){return this.gpair({with:{id:""}},this.sin.name)}cos(){return this.gpair({with:{id:""}},this.cos.name)}add(t){return this.gpair(t,this.add.name)}divide(t){return this.gpair(t,this.divide.name)}subtract(t){return this.gpair(t,this.subtract.name)}multiply(t){return this.gpair(t,this.multiply.name)}sum(t={}){return this.gself(t,this.sum.name)}min(t={}){return this.gself(t,this.min.name)}max(t={}){return this.gself(t,this.max.name)}norm(t={}){return this.gself(t,this.norm.name)}mean(t={}){return this.gself(t,this.mean.name)}matMult(t){return this.sanitize(t),ht.call({of:this,with:t.with,result:t.result||new ut({type:t.type,header:new v({shape:[this.shape[0],t.with.shape[1]]})}),meta:{method:this.matMult.name}})}cross(t){return this.sanitize(t),ht.call({of:this,with:t.with,result:t.result||new ut({type:t.type,header:new v({shape:[3,1]})}),meta:{method:this.cross.name}})}inverse(t={}){return ht.call({of:this,with:{id:""},result:t.result||ut.eye({shape:this.shape}),meta:{method:this.inverse.name}})}assign(t){this.sanitize(t);const e=t.region?this.slice({with:t.region}):this;return ht.call({of:e,with:t.with,result:e,meta:{axesSize:e.size,fullSize:e.size,axesShape:[...e.shape.keys()],fullShape:e.shape,method:e.assign.name}}),this}slice(t,e=this){return new ut({type:this.type,header:this.header.slice(t.with),init:function(){return e.data}})}T(t=this){return new ut({type:this.type,header:this.header.transpose(),init:function(){return t.data}})}reshape(t,e=this){return this.contig?new ut({type:this.type,header:this.header.reshape(t.shape),init:function(){return e.data}}):ut.array({with:this.toRaw()}).reshape({shape:t.shape})}toRaw(t=this.offset,e=0){return this.shape.length&&e!==this.shape.length?[...new Array(this.shape[e]).keys()].map(function(r){return this.toRaw(r*this.strides[e]+t,e+1)},this):m(this.data.real[t],this.data.imag[t])}valueOf(){return this.data.real[this.offset]}toString(){return JSON.stringify(this.toRaw()).replace(s,n)}[a.inspect.custom](){return this.toString()}}class ct{constructor(t){this.context=t.context,this.mapType=this.mapType.bind(this),this.createBuffer=this.createBuffer.bind(this)}createBuffer({array:t}){const e=this.context.createBuffer(),r=this.mapType({array:t}),a=this.context.STATIC_DRAW,i=this.context.ARRAY_BUFFER;return this.context.bindBuffer(i,e),this.context.bufferData(i,t.data.real,a),{buffer:e,size:t.shape[1],count:t.shape[0],type:r,normalize:!0,offset:t.offset*t.type.BYTES_PER_ELEMENT,stride:t.strides[0]*t.type.BYTES_PER_ELEMENT}}mapType({array:t}){return t.type===Int8Array?this.context.BYTE:t.type===Uint8Array?this.context.UNSIGNED_BYTE:t.type===Uint8ClampedArray?this.context.UNSIGNED_BYTE:t.type===Int16Array?this.context.SHORT:t.type===Uint16Array?this.context.UNSIGNED_SHORT:t.type===Int32Array?this.context.INT:t.type===Uint32Array?this.context.UNSIGNED_INT:t.type===Float32Array?this.context.FLOAT:null}}var ft={GRAPHICS_ENGINE_2D:"2d",GRAPHICS_ENGINE_3D:"3d",CONTEXT_2D:"2d",CONTEXT_WEB_GL:"webgl",HUD_FONT:"18px serif",HUD_COLOR:"rgba(255, 255, 255, 1)",HUD_TEXT_LOCATION:[10,50],HUD_Z_INDEX:1,HUD_POSITION_STYLE:"absolute",CANVAS_Z_INDEX:0,CANVAS_POSITION_STYLE:"absolute",CANVAS_STROKE_COLOR:"white",CANVAS_FILL_COLOR:"rgba(255, 165, 0, 1)",BINDINGS:{o:{name:"zoom",args:[!0]},i:{name:"zoom",args:[!1]},ArrowUp:{name:"pan",args:[0]},ArrowDown:{name:"pan",args:[1]},ArrowLeft:{name:"pan",args:[2]},ArrowRight:{name:"pan",args:[3]}},VERTEX_SOURCE:"attribute float a_PointSize;\nattribute vec4 a_Position;\nattribute vec4 a_Color;\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjMatrix;\nvarying vec4 v_Color;\nvoid main() {\n  gl_PointSize = a_PointSize;\n  gl_Position = u_ProjMatrix * u_ViewMatrix * a_Position;\n  v_Color = a_Color;\n}\n",FRAGMENT_SOURCE:"precision mediump float;\nvarying vec4 v_Color;\nvoid main() {\n  gl_FragColor = v_Color;\n}\n",TO_VECTOR:ut.array({with:[[1],[1],[1],[1]]}),UP_VECTOR:ut.array({with:[[0],[1],[0],[1]]}),FROM_VECTOR:ut.array({with:[[2],[2],[2],[1]]}),VIEWING_ANGLE:30,ASPECT_RATIO:1,NEAR:.1,FAR:100,ZOOM_DELTA:.5,PAN_DELTA:Math.PI/64,ACTIVE_VERTICES:0,UP_DIRECTION:0,DOWN_DIRECTION:1,LEFT_DIRECTION:2,RIGHT_DIRECTION:3};class gt{constructor(){this.config=ft,this.UP=this.config.UP_VECTOR,this.TO=this.config.TO_VECTOR,this.FROM=this.config.FROM_VECTOR;const t=Math.sin(this.config.PAN_DELTA),e=Math.cos(this.config.PAN_DELTA);this.upRot=ut.array({with:[[1,0,0,0],[0,e,-t,0],[0,t,e,0],[0,0,0,1]]}),this.downRot=ut.array({with:[[1,0,0,0],[0,e,t,0],[0,-t,e,0],[0,0,0,1]]}),this.leftRot=ut.array({with:[[e,0,t,0],[0,1,0,0],[-t,0,e,0],[0,0,0,1]]}),this.rightRot=ut.array({with:[[e,0,-t,0],[0,1,0,0],[t,0,e,0],[0,0,0,1]]})}lookAt(){const t=ut.eye({shape:[4,4]}),e=ut.eye({shape:[4,4]}),r=this.FROM.subtract({with:this.TO}),a=this.UP.cross({with:r}),i=r.divide({with:r.norm()}),s=a.divide({with:a.norm()}),n=i.cross({with:s});return t.assign({region:[":3",0],with:s}).assign({region:[":3",1],with:n}).assign({region:[":3",2],with:i}),e.assign({region:[3,":3"],with:this.FROM.multiply({with:-1})}),e.matMult({with:t})}project(){const t=Math.PI*this.config.VIEWING_ANGLE/180/2,e=1/(this.config.FAR-this.config.NEAR),r=Math.sin(t),a=Math.cos(t)/r,i=new Float32Array(16);return i[0]=a/this.config.ASPECT_RATIO,i[5]=a,i[10]=-(this.config.FAR+this.config.NEAR)*e,i[11]=-1,i[14]=-2*this.config.NEAR*this.config.FAR*e,ut.array({with:i}).reshape({shape:[4,4]})}rotate({orientation:t,viewMatrix:e,viewMatrixInv:r}){r.T().matMult({with:t}).matMult({with:e.T()}).matMult({with:this.TO,result:this.TO})}pan(t){const e=this.lookAt(),r=e.inverse();switch(t){case this.config.UP_DIRECTION:return this.rotate({orientation:this.upRot,viewMatrix:e,viewMatrixInv:r});case this.config.DOWN_DIRECTION:return this.rotate({orientation:this.downRot,viewMatrix:e,viewMatrixInv:r});case this.config.LEFT_DIRECTION:return this.rotate({orientation:this.leftRot,viewMatrix:e,viewMatrixInv:r});case this.config.RIGHT_DIRECTION:return this.rotate({orientation:this.rightRot,viewMatrix:e,viewMatrixInv:r})}}zoom(t){const e=t?"add":"subtract",r=this.FROM.subtract({with:this.TO}).multiply({with:this.config.ZOOM_DELTA});this.TO[e]({with:r,result:this.TO}),this.FROM[e]({with:r,result:this.FROM})}}class dt{constructor(t){this.config=ft,this.context=t.context,this.vertexShader=this.createShader({type:this.context.VERTEX_SHADER,source:ft.VERTEX_SOURCE}),this.fragmentShader=this.createShader({type:this.context.FRAGMENT_SHADER,source:ft.FRAGMENT_SOURCE}),this.program=this.createProgram()}createShader({type:t,source:e}){const r=this.context.createShader(t);return this.context.shaderSource(r,e),this.context.compileShader(r),this.context.getShaderParameter(r,this.context.COMPILE_STATUS)?r:(console.error(`Error with compile: ${this.context.getShaderInfoLog(r)}`),this.context.deleteShader(r),null)}createProgram(){const t=this.context.createProgram();return this.context.attachShader(t,this.vertexShader),this.context.attachShader(t,this.fragmentShader),this.context.linkProgram(t),this.context.getProgramParameter(t,this.context.LINK_STATUS)?t:(console.error(`Error with link: ${this.context.getProgramInfoLog(t)}`),this.context.deleteProgram(t),null)}}class mt{constructor(t){this.context=t.context,this.program=t.program,this.uniforms=this.createUniforms()}createUniforms(){const t={},e=this.context.getProgramParameter(this.program,this.context.ACTIVE_UNIFORMS);for(let r=0;r<e;r++){const e=this.context.getActiveUniform(this.program,r),a=this.context.getUniformLocation(this.program,e.name);t[e.name]=this.createUniform({type:e.type,location:a})}return t}createUniform({type:t,location:e}){return t===this.context.FLOAT_MAT2?function(t){this.context.uniformMatrix2fv(e,!1,t.data.real)}.bind(this):t===this.context.FLOAT_MAT3?function(t){this.context.uniformMatrix3fv(e,!1,t.data.real)}.bind(this):t===this.context.FLOAT_MAT4?function(t){this.context.uniformMatrix4fv(e,!1,t.data.real)}.bind(this):void 0}}class pt{constructor(t){this.program=t.program,this.context=t.context,this.attributes=this.createAttributes()}createAttributes(){const t={},e=this.context.getProgramParameter(this.program,this.context.ACTIVE_ATTRIBUTES);for(var r=0;r<e;r++){const e=this.context.getActiveAttrib(this.program,r),a=this.context.getAttribLocation(this.program,e.name);t[e.name]=this.createAttribute({location:a})}return t}createAttribute({location:t}){return function(e){this.context.bindBuffer(this.context.ARRAY_BUFFER,e.buffer),this.context.enableVertexAttribArray(t),this.context.vertexAttribPointer(t,e.size,e.type,e.normalize,e.stride,e.offset)}.bind(this)}}class yt{constructor(){this.config=ft,this.pan=this.pan.bind(this),this.zoom=this.zoom.bind(this),this.plot=this.plot.bind(this),this.start=this.start.bind(this),this.render=this.render.bind(this),this.start()}start(){return this.hud=document.createElement("canvas"),this.hud.style.zIndex=this.config.HUD_Z_INDEX,this.hud.style.position=this.config.HUD_POSITION_STYLE,this.canvas=document.createElement("canvas"),this.canvas.style.zIndex=this.config.CANVAS_Z_INDEX,this.canvas.style.position=this.config.CANVAS_POSITION_STYLE,this.resize(),this.canvas.context=this.canvas.getContext(this.config.CONTEXT_WEB_GL),this.cameraManager=new gt({}),this.bufferManager=new ct({context:this.canvas.context}),this.programManager=new dt({context:this.canvas.context}),this.uniformManager=new mt({context:this.canvas.context,program:this.programManager.program}),this.attributeManager=new pt({context:this.canvas.context,program:this.programManager.program}),this.canvas.context.useProgram(this.programManager.program),this.hud.context=this.hud.getContext(this.config.CONTEXT_2D),this.hud.context.font=this.config.HUD_FONT,this.hud.context.fillStyle=this.config.HUD_COLOR,document.body.prepend(this.hud),document.body.prepend(this.canvas),this}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.hud.width=.5*window.innerWidth,this.hud.height=.2*window.innerHeight,this.config.ASPECT_RATIO=this.canvas.width/this.canvas.height}plot({vertices:t,colors:e,sizes:r}){this.attributeManager.attributes.a_Color(this.bufferManager.createBuffer({array:e})),this.attributeManager.attributes.a_PointSize(this.bufferManager.createBuffer({array:r})),this.attributeManager.attributes.a_Position(this.bufferManager.createBuffer({array:t})),this.config.ACTIVE_VERTICES=t.shape[0],this.render()}render(){const t=this.cameraManager.lookAt(),e=this.cameraManager.project();this.uniformManager.uniforms.u_ViewMatrix(t),this.uniformManager.uniforms.u_ProjMatrix(e),this.canvas.context.clear(this.canvas.context.COLOR_BUFFER_BIT),this.canvas.context.drawArrays(this.canvas.context.LINE_STRIP,0,this.config.ACTIVE_VERTICES)}pan(t){this.cameraManager.pan(t),this.render()}zoom(t){this.cameraManager.zoom(t),this.hud.context.clearRect(0,0,this.hud.width,this.hud.height),this.hud.context.fillText(`loc | r: ${Math.round(255*this.config.FROM_VECTOR.data.real[0])} g: ${Math.round(255*this.config.FROM_VECTOR.data.real[1])}, b: ${Math.round(255*this.config.FROM_VECTOR.data.real[2])}`,10,70),this.render()}}class wt{constructor(t){this.isPressed=t.isPressed||!1,this.position=t.position||{x:0,y:0}}mouseup(){this.isPressed=!1}mousedown(t){this.isPressed=!0,this.position.x=t.clientX,this.position.y=t.clientY}mousemove(t){this.position.x=t.clientX,this.position.y=t.clientY}}class It{constructor(t){this.keys=t.keys||new Set,this.bindings=t.bindings}keyup(){this.keys.clear()}keydown(t){this.keys.add(t.key);const e=Array.from(this.keys).sort().join("|");return this.bindings[e]}}var Rt=new class{constructor(){this.config=ft,this.keyup=this.keyup.bind(this),this.resize=this.resize.bind(this),this.keydown=this.keydown.bind(this),this.mouseup=this.mouseup.bind(this),this.mousedown=this.mousedown.bind(this),this.mousemove=this.mousemove.bind(this),this.mouse=new wt({location:{x:0,y:0}}),this.keyboard=new It({bindings:this.config.BINDINGS}),this.graphics=new yt({}),window.addEventListener("resize",this.resize),window.addEventListener("keyup",this.keyup),window.addEventListener("keydown",this.keydown),window.addEventListener("mouseup",this.mouseup),window.addEventListener("mousedown",this.mousedown),window.addEventListener("mousemove",this.mousemove)}mouseup(){this.mouse.mouseup()}mousedown(t){this.mouse.mousedown(t)}mousemove(t){this.mouse.mousemove(t)}keyup(){this.keyboard.keyup()}keydown(t){const e=this.keyboard.keydown(t);if(e){t.preventDefault(),(0,this.graphics[e.name])(...e.args)}}resize(){this.graphics.resize()}};window.bb=ut,window.myio=class{static async imread(t){const e=document.createElement("canvas"),r=e.getContext("2d"),a=await fetch(t),i=await a.blob(),s=await createImageBitmap(i),n=[0,0,s.width,s.height];return e.width=s.width,e.height=s.height,r.drawImage(s,...n),e.remove(),{shape:[s.width,s.height,4],pixels:r.getImageData(...n).data,binary:s}}},window.app=Rt;e.default=async function(){window.vertices=ut.zeros({shape:[1e4,2]});const t=ut.arange({stop:1e4}).divide({with:10}).sin().multiply({with:10}),e=ut.arange({stop:1e4}).divide({with:10});vertices.assign({region:[":",0],with:e}).assign({region:[":",1],with:t}),window.colors=ut.zeros({shape:[1e4,3]}).assign({region:[":",1],with:255}),window.sizes=ut.ones({shape:[1e4,1]}).multiply({with:1}),app.graphics.plot({vertices:vertices,colors:colors,sizes:sizes})}()}]);
//# sourceMappingURL=main.js.map